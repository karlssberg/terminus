using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp.Syntax;
using static Microsoft.CodeAnalysis.CSharp.SyntaxFactory;
using static Terminus.Generator.Builders.FacadeBuilder;

namespace Terminus.Generator.Builders;

internal static class SourceBuilder
{
    internal static CompilationUnitSyntax GenerateAggregatorFacadeMethods(AggregatorContext aggregatorContext)
    {
        var namespaceCode = GenerateAggregatorTypeDeclarations(aggregatorContext).NormalizeWhitespace().ToFullString().TrimStart();
        
        var rawCompilationUnit = $"// <auto-generated/> Generated by Terminus FacadeGenerator\r\n#nullable enable\r\n{namespaceCode}";

        return ParseCompilationUnit(rawCompilationUnit);
    }
}