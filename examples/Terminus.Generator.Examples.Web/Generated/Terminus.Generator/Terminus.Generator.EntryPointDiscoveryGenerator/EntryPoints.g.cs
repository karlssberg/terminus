// <auto-generated/> Generated by Terminus EntryPointDiscoveryGenerator
// WARNING: No mediator interfaces found. Define interfaces with [EntryPointMediator] attribute.
#nullable enable
using Microsoft.Extensions.DependencyInjection;
using System;
using System.Reflection;
using Terminus;
using Terminus.Attributes;
using Terminus.Strategies;

namespace Terminus.Generated
{
    public static partial class ServiceCollectionExtensions
    {
        public static IServiceCollection AddEntryPoints<TAttribute>(this IServiceCollection services, Action<ParameterBindingStrategyResolver>? configure = null)
            where TAttribute : EntryPointAttribute
        {
            var resolver = new ParameterBindingStrategyResolver();
            configure?.Invoke(resolver);
            if (typeof(Terminus.Generator.Examples.Web.MyHttpPostAttribute) == typeof(TAttribute))
            {
                services.AddSingleton<EntryPointDescriptor<TAttribute>>(new EntryPointDescriptor<TAttribute>(typeof(Terminus.Generator.Examples.Web.MyHttpEntryPoints).GetMethod("GetPost", new System.Type[] { typeof(string), typeof(string) }), context => ((Terminus.Generator.Examples.Web.MyHttpEntryPoints)instance).GetPost(resolver.ResolveParameter<string>("id", context), resolver.ResolveParameter<string>("postId", context))));
            }
            else
            {
                throw new InvalidOperationException($"'{typeof(TAttribute)}' is not applied to any methods");
            }

            return services;
        }

        public static IServiceCollection AddEntryPoints(this IServiceCollection services, Action<ParameterBindingStrategyResolver>? configure = null)
        {
            return services.AddEntryPoints<Terminus.Attributes.EntryPointAttribute>(configure);
        }
    }
}