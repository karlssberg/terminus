// <auto-generated/> Generated by Terminus EntryPointDiscoveryGenerator
#nullable enable
using Microsoft.Extensions.DependencyInjection;
using System;
using System.Reflection;
using Terminus;
using Terminus.Strategies;

namespace Terminus.Generator.Examples.HelloWorld
{
    public partial interface IFacade
    {
        void Handle(string message);
        System.Threading.Tasks.Task<string> Query(string message1, string message2, System.Threading.CancellationToken cancellationToken);
    }

    internal sealed class IFacade_Generated : Terminus.Generator.Examples.HelloWorld.IFacade
    {
        private readonly IServiceProvider _serviceProvider;
        private readonly Terminus.Dispatcher<Terminus.Generator.Examples.HelloWorld.IFacade> _dispatcher;
        public IFacade_Generated(IServiceProvider serviceProvider, Terminus.Dispatcher<Terminus.Generator.Examples.HelloWorld.IFacade> dispatcher)
        {
            _serviceProvider = serviceProvider;
            _dispatcher = dispatcher;
        }

        public void Handle(string message)
        {
            _serviceProvider.GetRequiredService<Terminus.Generator.Examples.HelloWorld.MyService>().Handle(message);
        }

        public async System.Threading.Tasks.Task<string> Query(string message1, string message2, System.Threading.CancellationToken cancellationToken)
        {
            cancellationToken.ThrowIfCancellationRequested();
            return await Terminus.Generator.Examples.HelloWorld.MyOtherService.Query(message1, message2, cancellationToken).ConfigureAwait(false);
        }
    }
}

namespace Terminus
{
    public static partial class ServiceCollectionExtensions__Generated
    {
        private static IServiceCollection AddEntryPointsFor_Terminus_Generator_Examples_HelloWorld_IFacade(this IServiceCollection services, Action<ParameterBindingStrategyCollection>? configure = null)
        {
            services.AddKeyedSingleton<Terminus.ParameterBindingStrategyCollection>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade), (provider, _) =>
            {
                var collection = new Terminus.ParameterBindingStrategyCollection();
                configure?.Invoke(collection);
                return collection;
            });
            services.AddKeyedTransient<Terminus.ParameterBindingStrategyResolver>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade), (provider, key) =>
            {
                var collection = provider.GetRequiredKeyedService<Terminus.ParameterBindingStrategyCollection>(key);
                return new Terminus.ParameterBindingStrategyResolver(provider, collection);
            });
            services.AddTransient<Dispatcher<Terminus.Generator.Examples.HelloWorld.IFacade>>();
            services.AddTransient<IEntryPointRouter<Terminus.Generator.Examples.HelloWorld.IFacade>, DefaultEntryPointRouter<Terminus.Generator.Examples.HelloWorld.IFacade>>();
            services.AddKeyedSingleton<EntryPointDescriptor<Terminus.EntryPointAttribute>>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade), (provider, key) => new EntryPointDescriptor<Terminus.EntryPointAttribute>(typeof(Terminus.Generator.Examples.HelloWorld.MyService).GetMethod("Handle", new System.Type[] { typeof(string) })!, (context, ct) => provider.GetRequiredService<Terminus.Generator.Examples.HelloWorld.MyService>().Handle(provider.GetRequiredKeyedService<ParameterBindingStrategyResolver>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade)).ResolveParameter<string>("message", context))));
            services.AddKeyedSingleton<EntryPointDescriptor<Terminus.EntryPointAttribute>>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade), (provider, key) => new EntryPointDescriptor<Terminus.EntryPointAttribute>(typeof(Terminus.Generator.Examples.HelloWorld.MyOtherService).GetMethod("Query", new System.Type[] { typeof(string), typeof(string), typeof(System.Threading.CancellationToken) })!, (context, ct) => Terminus.Generator.Examples.HelloWorld.MyOtherService.Query(provider.GetRequiredKeyedService<ParameterBindingStrategyResolver>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade)).ResolveParameter<string>("message1", context), provider.GetRequiredKeyedService<ParameterBindingStrategyResolver>(typeof(Terminus.Generator.Examples.HelloWorld.IFacade)).ResolveParameter<string>("message2", context), ct)));
            services.AddTransient<Terminus.Generator.Examples.HelloWorld.MyService>();
            services.AddTransient<Terminus.Generator.Examples.HelloWorld.MyOtherService>();
            services.AddSingleton<Terminus.Generator.Examples.HelloWorld.IFacade, Terminus.Generator.Examples.HelloWorld.IFacade_Generated>();
            return services;
        }
    }
}